<html><head>
<meta http-equiv="content-type" content="text/html; charset=euc-kr">
<title>날짜 선택</title>
<style type="text/css">
body { margin:4px; }
body,input.button { background-color:#D4D0C8; color:black; }
body,th,td,input,select { font-family:Gulim; font-size:12px; }
input.spinbtn { font-size:9px; }
table { background-color:white; border:2px inset white; cursor:default; }
table tr { height:18px; }
table th { background-color:#808080; color:#D4D0C8; font-weight:normal; }
table td { text-align:center; }
table td.selected { background-color:#0A246A; color:white; }
</style>
<script language="Javascript">
var dArg, curDate, curCell;
var initDateStr = (dArg = window.dialogArguments) ? dArg.value : false;
var oDate = new Date();
var dateCells = new Array();

function padZeros(num, size) {
  var str = num.toString();
  var numZeros = size - str.length;
  for (var i = 0; i < numZeros; i++) str = "0" + str;
  return str;
}

function showCal() {
  var form = document.dateForm;
  var year = oDate.getYear();
  var month = oDate.getMonth();
  var date = oDate.getDate();
  var i, dval, oCell;

  if (!curDate) curDate = date;

  var thisMonth = new Date(oDate);
  thisMonth.setDate(1);
  var dayof1 = thisMonth.getDay();

  var nextMonth = new Date(oDate);
  nextMonth.setDate(1); nextMonth.setMonth(month + 1); nextMonth.setDate(0);
  var numdays = nextMonth.getDate();

  form.year.value = oDate.getYear();
  form.month.selectedIndex = oDate.getMonth();

  for (i=0; i<42; i++) dateCells[i].innerText = "";
  if (curCell) curCell.className = "";

  if (curDate > numdays) curDate = numdays;
  for (i=0; i<numdays; i++) {
    dval = i + 1; oCell = dateCells[i + dayof1];
    oCell.innerText = dval;
    if (dval == curDate) (curCell = oCell).className = "selected";
  }
}

function nextMonth() { oDate.setMonth(oDate.getMonth() + 1); showCal(); }
function prevMonth() { oDate.setMonth(oDate.getMonth() - 1); showCal(); }

function cellOnClick() {
  if (this.innerText=="") return;
  curDate = parseInt(this.innerText);
  curCell.className = "";
  (curCell = this).className = "selected";
}

function cellOnDblClick() { dArg.value = getDateStr(); self.close(); }

function updateYear(obj)
{
  var year = parseInt(obj.value);
  if (isNaN(year)) return false;
  var testDate = new Date();
  testDate.setYear(year);
  if (testDate.getYear() != year) return false;
  oDate.setYear(year);
  showCal();
  return true;
}

function updateMonth(obj)
{
  var month = obj.selectedIndex;
  oDate.setMonth(month);
  showCal();
}

function getDateStr()
{
  var form = document.dateForm;
  return form.year.value + form.month[form.month.selectedIndex].value + padZeros(curDate,2);
}

function init() {
  var row, cell;
  var tbody = calTable.childNodes[0];
  calTable.appendChild(tbody);
  for (var i=0; i<6; i++) {
    row = document.createElement("TR");
    tbody.appendChild(row);
    for (var j=0; j<7; j++) {
      cell = document.createElement("TD");
      row.appendChild(cell);
      dateCells[i*7+j] = cell;
      cell.onclick = cellOnClick;
      cell.ondblclick = cellOnDblClick;
    }
  }
  showCal();
}

function enter(obj)
{
	if(event.keyCode == 13)
	{
		updateYear(obj);
	}
}
</script>
<body onLoad="init()">

<div align="center">
<form name="dateForm" style="text-align:center" onSubmit="return false">
<input type="button" class="button spinbtn" value=" ◀ " onmouseup="prevMonth()" tabindex="-1">
&nbsp;
<input type="text" name="year" size="4" maxlength="4" onChange="return updateYear(this)"
  style="width:50px;text-align:center;ime-mode:disabled" tabindex="-1" onkeypress="return enter(this);">&nbsp;
<select name="month" style="width:60px" onChange="updateMonth(this)" tabindex="-1">
  <option value="01">Jan</option><option value="02">Feb</option><option value="03">Mar</option>
  <option value="04">Apr</option><option value="05">May</option><option value="06">Jun</option>
  <option value="07">Jul</option><option value="08">Aug</option><option value="09">Sep</option>
  <option value="10">Oct</option><option value="11">Nov</option><option value="12">Dec</option>
</select>
&nbsp;
<input type="button" class="button spinbtn" value=" ▶ " onmouseup="nextMonth()" tabindex="-1">

<table id="calTable" cellspacing="0" cellpadding="2"
  style="margin:4px;table-layout:fixed;border-collapse:collapse">
  <tr>
    <th width="30">Sun</th><th width="30">Mon</th><th width="30">Tue</th>
    <th width="30">Web</th><th width="30">Thu</th><th width="30">Fri</th>
    <th width="30">Sat</th>
  </tr>
</table>

<input type="button" value="Submit" onClick="dArg.value=getDateStr();self.close()">
<input type="button" value="Cancel" onClick="self.close()">
</form>
</div>

</body></html>